<script lang="ts">
	import { getHeroes } from '$lib/api/client';
	import type { Hero } from '$lib/types/encyclopedia';
	import { onMount } from 'svelte';

	let heroes = $state<Hero[]>([]);
	let loading = $state(true);

	onMount(async () => {
		heroes = await getHeroes();
		loading = false;
	});
</svelte>

<div class="min-h-screen grid-bg">
	<nav class="glass border-b border-slate-700/50">
		<div class="max-w-7xl mx-auto px-4 py-4">
			<div class="flex items-center justify-between">
				<h1 class="font-display text-2xl font-bold text-primary-400">
					Auto Chess Encyclopedia
				</h1>
				<div class="flex gap-4">
					<a href="/" class="text-slate-300 hover:text-white">Squad Builder</a>
					<a href="/heroes" class="text-white">Heroes</a>
					<a href="/races" class="text-slate-300 hover:text-white">Races</a>
					<a href="/classes" class="text-slate-300 hover:text-white">Classes</a>
				</div>
			</div>
		</div>
	</nav>

	<main class="max-w-7xl mx-auto px-4 py-8">
		<h2 class="font-display text-3xl font-bold text-slate-100 mb-6">Heroes</h2>

		{#if loading}
			<div class="text-center text-slate-400">Loading...</div>
		{:else}
			<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
				{#each heroes as hero}
					<a
						href="/heroes/{hero.Id}"
						class="hero-card glass rounded-lg p-4 block transition-all duration-300 hover:translate-y-[-2px]"
						style="border-left: 3px solid {hero.Quality === 'legendary' ? '#fbbf24' : hero.Quality === 'epic' ? '#a78bfa' : hero.Quality === 'rare' ? '#60a5fa' : hero.Quality === 'uncommon' ? '#4ade80' : '#e2e8f0'}"
					>
						<div class="flex items-start gap-4">
							<div class="hero-icon" class:bg-{hero.Quality}>
								<span class="hero-initial">{hero.Name.charAt(0)}</span>
							</div>
							<div class="flex-1 min-w-0">
								<h3 class="hero-name">{hero.Name}</h3>
								<div class="hero-meta">
									<span class="hero-cost">{hero.Cost}g</span>
									<span class="hero-tier quality-{hero.Quality}">{hero.Quality}</span>
								</div>
							</div>
						</div>
						<div class="hero-ability mt-3">
							<span class="ability-name">{hero.AbilityName}</span>
							<p class="ability-text">{hero.AbilityDescription}</p>
						</div>
					</a>
				{/each}
			</div>
		{/if}
	</main>
</div>

<style>
	.hero-card:hover {
		box-shadow: 0 8px 16px -4px rgba(0, 0, 0, 0.4);
	}

	.hero-icon {
		width: 3rem;
		height: 3rem;
		border-radius: 0.375rem;
		border: 2px solid;
		display: flex;
		align-items: center;
		justify-content: center;
		background: rgba(15, 23, 42, 0.8);
		flex-shrink: 0;
	}

	.hero-icon.bg-legendary { border-color: #fbbf24; }
	.hero-icon.bg-epic { border-color: #a78bfa; }
	.hero-icon.bg-rare { border-color: #60a5fa; }
	.hero-icon.bg-uncommon { border-color: #4ade80; }
	.hero-icon.bg-common { border-color: #e2e8f0; }

	.hero-initial {
		font-family: var(--font-display);
		font-size: 1.5rem;
		font-weight: 700;
		color: #e2e8f0;
	}

	.hero-name {
		font-family: var(--font-display);
		font-size: 1.125rem;
		font-weight: 600;
		color: #e2e8f0;
		margin: 0 0 0.25rem 0;
	}

	.hero-meta {
		display: flex;
		gap: 0.5rem;
		align-items: center;
	}

	.hero-cost {
		font-family: var(--font-mono);
		font-size: 0.875rem;
		font-weight: 700;
		color: #fbbf24;
	}

	.hero-tier {
		font-size: 0.625rem;
		font-weight: 600;
		text-transform: uppercase;
		letter-spacing: 0.05em;
		padding: 0.125rem 0.375rem;
		border-radius: 0.25rem;
	}

	.hero-tier.quality-common { background: rgba(226, 232, 240, 0.15); color: #cbd5e1; }
	.hero-tier.quality-uncommon { background: rgba(74, 222, 128, 0.15); color: #4ade80; }
	.hero-tier.quality-rare { background: rgba(96, 165, 250, 0.15); color: #60a5fa; }
	.hero-tier.quality-epic { background: rgba(167, 139, 250, 0.15); color: #a78bfa; }
	.hero-tier.quality-legendary { background: rgba(251, 191, 36, 0.15); color: #fbbf24; }

	.hero-ability {
		background: rgba(15, 23, 42, 0.5);
		padding: 0.5rem;
		border-radius: 0.375rem;
		margin-top: 0.75rem;
	}

	.ability-name {
		display: block;
		font-size: 0.75rem;
		font-weight: 600;
		color: #60a5fa;
		margin-bottom: 0.25rem;
	}

	.ability-text {
		font-size: 0.75rem;
		color: rgba(148, 163, 184, 0.8);
		margin: 0;
		line-height: 1.4;
	}
</style>
